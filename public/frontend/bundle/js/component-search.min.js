/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!*******************************************************!*\
  !*** ./resources/src/frontend/js/component-search.js ***!
  \*******************************************************/
function _typeof(o) { "@babel/helpers - typeof"; return _typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function (o) { return typeof o; } : function (o) { return o && "function" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? "symbol" : typeof o; }, _typeof(o); }
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { _defineProperty(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; }
function _defineProperty(obj, key, value) { key = _toPropertyKey(key); if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }
function _toPropertyKey(t) { var i = _toPrimitive(t, "string"); return "symbol" == _typeof(i) ? i : i + ""; }
function _toPrimitive(t, r) { if ("object" != _typeof(t) || !t) return t; var e = t[Symbol.toPrimitive]; if (void 0 !== e) { var i = e.call(t, r || "default"); if ("object" != _typeof(i)) return i; throw new TypeError("@@toPrimitive must return a primitive value."); } return ("string" === r ? String : Number)(t); }
var SEARCH_INVENTORY = {
  elements: {
    show_up: $('[data-collection-linked-inventory="show-up"]'),
    btn_load_more: $('[data-collection-linked-inventory="btn_load_more"]'),
    sort_by: $('[data-collection-linked-inventory="sort_by"]'),
    pagination: $('[data-collection-linked-inventory="pagination"]'),
    total_product: $('[data-collection-linked-inventory="total_product"]')
  },
  init: function init() {
    SEARCH_INVENTORY.loadInitInventories();
    SEARCH_INVENTORY.loadMoreInventories();
    SEARCH_INVENTORY.loadBySortInventories();
  },
  ajaxInventories: function ajaxInventories() {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var _ref = arguments.length > 1 ? arguments[1] : undefined,
      beforeSendCb = _ref.beforeSendCb,
      successCb = _ref.successCb,
      errorCb = _ref.errorCb;
    beforeSendCb = beforeSendCb || function () {};
    successCb = successCb || function () {};
    errorCb = errorCb || function () {};
    var payload = _objectSpread({
      paging: 'simplePaginate',
      per_page: 12,
      sort_by: SEARCH_INVENTORY.elements.sort_by.val(),
      page: SEARCH_INVENTORY.elements.btn_load_more.attr('data-current-page'),
      query: $('[data-search-query]').text()
    }, data);
    $.ajax({
      url: CATALOG_ROUTES.api_search_inventories,
      method: 'GET',
      data: payload,
      beforeSend: beforeSendCb,
      success: successCb,
      error: errorCb
    });
  },
  loadBySortInventories: function loadBySortInventories() {
    SEARCH_INVENTORY.elements.sort_by.on('change', function () {
      var value = $(this).val();
      var currentPage = SEARCH_INVENTORY.elements.btn_load_more.attr('data-current-page');
      SEARCH_INVENTORY.elements.sort_by.find('option').prop('selected', false);
      SEARCH_INVENTORY.elements.sort_by.find("option[value=\"".concat(value, "\"]")).prop('selected', true);
      SEARCH_INVENTORY.ajaxInventories(_defineProperty({
        page: currentPage,
        sort_by: value
      }, "page", 1), {
        beforeSendCb: function beforeSendCb() {
          SEARCH_INVENTORY.elements.sort_by.prop('disabled', true);
        },
        successCb: function successCb(response) {
          var htmlInventories = SEARCH_INVENTORY.buildHTMLInventories((response === null || response === void 0 ? void 0 : response.data) || []);
          SEARCH_INVENTORY.elements.sort_by.prop('disabled', false);
          SEARCH_INVENTORY.elements.show_up.html(htmlInventories);
          SEARCH_INVENTORY.setPagination(response);
          SEARCH_INVENTORY.updateUrl(response);
          SEARCH_INVENTORY.countDisplayingProducts(response);
        }
      });
    });
  },
  loadMoreInventories: function loadMoreInventories() {
    SEARCH_INVENTORY.elements.btn_load_more.on('click', function (e) {
      e.preventDefault();
      var nextPage = $(this).attr('data-next-page');
      SEARCH_INVENTORY.ajaxInventories({
        page: nextPage
      }, {
        beforeSendCb: function beforeSendCb() {
          SEARCH_INVENTORY.elements.btn_load_more.text('Loading...');
        },
        successCb: function successCb(response) {
          var htmlInventories = SEARCH_INVENTORY.buildHTMLInventories((response === null || response === void 0 ? void 0 : response.data) || []);
          SEARCH_INVENTORY.elements.show_up.append(htmlInventories);
          SEARCH_INVENTORY.setPagination(response);
          SEARCH_INVENTORY.updateUrl(response);
          SEARCH_INVENTORY.countDisplayingProducts(response);
        }
      });
    });
  },
  loadInitInventories: function loadInitInventories() {
    SEARCH_INVENTORY.ajaxInventories({}, {
      beforeSendCb: function beforeSendCb() {
        SEARCH_INVENTORY.elements.pagination.addClass('d-none');
        SEARCH_INVENTORY.elements.show_up.html('<div>Loading ...</div>');
      },
      successCb: function successCb(response) {
        var htmlInventories = SEARCH_INVENTORY.buildHTMLInventories((response === null || response === void 0 ? void 0 : response.data) || []);
        SEARCH_INVENTORY.elements.show_up.html(htmlInventories);
        SEARCH_INVENTORY.setPagination(response);
        SEARCH_INVENTORY.updateUrl(response);
        SEARCH_INVENTORY.countDisplayingProducts(response);
      }
    });
  },
  setPagination: function setPagination(response) {
    SEARCH_INVENTORY.elements.btn_load_more.attr('data-current-page', response.current_page);
    if (response !== null && response !== void 0 && response.has_more && response !== null && response !== void 0 && response.current_page) {
      SEARCH_INVENTORY.elements.pagination.removeClass('d-none');
      SEARCH_INVENTORY.elements.btn_load_more.text('Xem ThÃªm');
      SEARCH_INVENTORY.elements.btn_load_more.attr('href', "".concat(SEARCH_INVENTORY.baseRoute, "?page=").concat(response.current_page + 1));
      SEARCH_INVENTORY.elements.btn_load_more.attr('data-next-page', response.current_page + 1);
    } else {
      SEARCH_INVENTORY.elements.pagination.addClass('d-none');
      SEARCH_INVENTORY.elements.btn_load_more.html('');
    }
  },
  countDisplayingProducts: function countDisplayingProducts(response) {
    var totalCount = $('[data-collection-linked-inventory="show-up"] li').length;
    SEARCH_INVENTORY.elements.total_product.attr('data-total', totalCount);
    SEARCH_INVENTORY.elements.total_product.text(totalCount);
  },
  updateUrl: function updateUrl(response) {},
  buildHTMLInventories: function buildHTMLInventories(inventories) {
    var _html = inventories.map(function (inventory) {
      var _inventory$product, _inventory$product2;
      var route = PRODUCT_ROUTES.web_detail.replace(':slug', inventory === null || inventory === void 0 ? void 0 : inventory.slug);
      return "\n            <li class=\"grid__item\">\n                <div class=\"card-wrapper underline-links-hover\">\n                    <div class=\"card card--standard card--media\" style=\"--ratio-percent: 100%;\">\n                        <div class=\"card__inner color-background-2 gradient ratio\" style=\"--ratio-percent: 100%;\">\n                            <div class=\"card__media\">\n                                <div class=\"media media--transparent media--hover-effect\">\n                                    <img srcset=\"".concat(inventory === null || inventory === void 0 ? void 0 : inventory.image, "\" src=\"").concat(inventory === null || inventory === void 0 ? void 0 : inventory.image, "\" sizes=\"(min-width: 1600px) 367px, (min-width: 990px) calc((100vw - 130px) / 4), (min-width: 750px) calc((100vw - 120px) / 3), calc((100vw - 35px) / 2)\" alt=\"").concat(inventory === null || inventory === void 0 ? void 0 : inventory.title, "\" class=\"motion-reduce\" width=\"1000\" height=\"1000\">\n                                </div>\n                            </div>\n                            <div class=\"card__content\">\n                                <div class=\"card__information\">\n                                    <h3 class=\"card__heading\">\n                                        <a href=\"").concat(route, "\" class=\"full-unstyled-link\">").concat(inventory === null || inventory === void 0 ? void 0 : inventory.title, "</a>\n                                    </h3>\n                                </div>\n                                <div class=\"card__badge bottom left\"></div>\n                            </div>\n                        </div>\n                        <div class=\"card__content\">\n                            <div class=\"card__information\">\n                                <h3 class=\"card__heading h5\">\n                                <a href=\"").concat(route, "\" class=\"full-unstyled-link\" style=\"text-decoration: none;\">").concat(inventory === null || inventory === void 0 ? void 0 : inventory.title, "</a>\n                                </h3>\n                                <div class=\"card-information\" style=\"padding: 4px 0;\">\n                                    <div class=\"price\">\n                                        <div class=\"ls-reviewer\">\n                                            ").concat(inventory !== null && inventory !== void 0 && (_inventory$product = inventory.product) !== null && _inventory$product !== void 0 && _inventory$product.positive_review_count ? "<b>".concat(inventory === null || inventory === void 0 || (_inventory$product2 = inventory.product) === null || _inventory$product2 === void 0 ? void 0 : _inventory$product2.positive_review_count, "</b> \u0111\xE1nh gi\xE1 t\xEDch c\u1EF1c") : '', "\n                                        </div>\n                                        <div class=\"price__regular\">\n                                            <div class=\"ls-price-group\">\n                                                <div>\n                                                    <span class=\"price-item price-item--regular\">").concat(inventory.final_price, " </span>\n                                                    ").concat(inventory.has_offer_price ? "<del class=\"price-item--sub\">".concat(inventory.sub_price, "</del>") : '', "\n                                                </div>\n                                                <span class=\"sold-count\">\u0110\xE3 b\xE1n ").concat(inventory.final_sold_count, "</span>\n                                            </div>\n\n                                            ").concat(inventory.has_offer_price ? "\n                                                    <span class=\"price-discount-percent discount-absolute\">-".concat(inventory.discount_percent, "%</span>\n                                                    <div class=\"price-for-saving\">(Ti\u1EBFt ki\u1EC7m <span>").concat(inventory.price_for_saving, "</span>)</div>\n                                                ") : '', "\n                                        </div>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class=\"quick-add\">\n                                <a type=\"submit\" name=\"add\" class=\"quick-add__submit button button--full-width button--secondary\" data-product-url=\"").concat(route, "\" href=\"").concat(route, "\">\n                                    Xem Chi Ti\u1EBFt\n                                    <div class=\"loading-overlay__spinner hidden\">\n                                        <svg focusable=\"false\" class=\"spinner\" viewBox=\"0 0 66 66\" xmlns=\"http://www.w3.org/2000/svg\">\n                                            <circle class=\"path\" fill=\"none\" stroke-width=\"6\" cx=\"33\" cy=\"33\" r=\"30\"></circle>\n                                        </svg>\n                                    </div>\n                                </a>\n                            </div>\n                            <div class=\"card__badge bottom left\"></div>\n                        </div>\n                    </div>\n                </div>\n            </li>\n            ");
    });
    return _html.join('');
  }
};
SEARCH_INVENTORY.init();
/******/ })()
;